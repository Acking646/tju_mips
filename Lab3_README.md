# Lab3: TEMU  (Group 2)

## 1. 实现说明
Lab3由**Group 2 实现, 具体内容为：TEMU仿真器的基础命令、MIPS指令以及图形化界面的实现。

---

## 2. 实现清单
按照实验要求，实现如下功能与指令：

- [x] **支持所要求的指令 (35/35分)**
    - [x] 已实现 14+3 条MIPS 指令（lui, ori, addu, addiu, beq, bne, bgez, lw, sw, lb, sb, sll, sllv, andi, or, xor, add）。
    - [x] 全部指令通过了逻辑对账与符号扩展测试。

- [x] **基础调试功能 (15/15分)**
    - [x] **单步执行 (`si`)**: 支持逐条或指定步数执行。
    - [x] **打印寄存器 (`info r`)**: 实时显示 32 个通用寄存器及 PC值。
    - [x] **扫描内存 (`x`)**: 支持任意合法地址段的十六进制内存倒出。

- [x] **表达式求值 (15/15分)**
    - [x] 支持包含寄存器（如 `$t0`）、十六进制常数及逻辑运算符的表达式解析。

- [x] **监视点系统 (15/15分)**
    - [x] **设置监视点 (`w`)**: 当表达式值变化时程序自动暂停。
    - [x] **删除监视点 (`d`)**: 支持根据编号管理和移除监视点。

- [x] **Golden Trace 输出 (15/15分)**
    - [x] 成功实现 `log_golden_trace` 接口。
    - [x] 输出格式符合指令对账规范

- [x] **图形界面支持 (5/5分)**
    - [x] 支持实验要求的图形界面显示功能。


---

## 3. 指令验证说明
### 3.1 已实现指令集 (Total: 14+3)
- **算术运算**: `add`, `addu`, `addiu`
- **逻辑运算**: `lui`, `ori`, `andi`, `or`, `xor`
- **移位运算**: `sll`, `sllv`
- **访存指令**: `lw`, `sw`, `lb`, `sb`
- **分支/跳转**: `beq`, `bne`, `bgez`

### 3.2 自动化测试逻辑
我们编写了自定义测试脚本 `instr_test.S`，核心验证流程如下：
1. **立即数符号扩展**：通过 `addiu $s1, $zero, -40` 验证符号位正确填充。
2. **变量移位逻辑**：通过 `sllv` 验证移位量（shamt）从寄存器低 5 位动态读取的准确性。
3. **访存符号扩展**：存入字节 `0xAF` 后利用 `lb` 加载，验证其结果是否正确扩展为 `0xFFFFFFAF`。
4. **分支跳转准确性**：通过逻辑比对（`bne`/`bgez`），若运算错误则进入 `label_fail` 死循环，若全部正确则正常退出并生成 Trace。

---

## 4. 测试结果对账 (Golden Trace)
测试说明：
进入mips_sc重新make后重新编译运行TEMU, 此时程序入口为instr_test.S，直接运行命令c得到`log`与 `golden_trace.txt`, 与标准测试输出进行对照。

---
## 5. 图形化界面说明(GUI)
**另附GUI_使用说明(具体可查看): 需要系统安装 SDL2 和 SDL2_ttf 库**

效果如下图
![GUI效果图](GUI.png)

#include "trap.h"
.set noat
.set noreorder
.globl main
.text
main:
    # ==============================
    # 测试 1: lui 加载立即数到高位
    # ==============================
    lui $t0, 0x1234             # $t0 = 0x12340000
    lui $t1, 0x8000             # $t1 = 0x80000000 (符号位测试)
    lui $t2, 0x0001             # $t2 = 0x00010000
    lui $t3, 0xFFFF             # $t3 = 0xFFFF0000
    
    # ==============================
    # 测试 2: ori 或立即数
    # ==============================
    ori $s0, $t0, 0x5678        # $s0 = 0x12345678
    ori $s1, $zero, 0xFFFF      # $s1 = 0x0000FFFF
    ori $s2, $zero, 0x0F0F      # $s2 = 0x00000F0F
    ori $s3, $t1, 0x0000        # $s3 = 0x80000000
    
    # ==============================
    # 测试 3: andi 与立即数
    # ==============================
    andi $s4, $s0, 0xF0F0      # $s4 = 0x12340508 & 0xF0F0 = 0x00005000
    andi $s5, $s1, 0xFF00      # $s5 = 0x0000FF00
    andi $s6, $s2, 0x0F0F      # $s6 = 0x00000F0F
    
    # ==============================
    # 测试 4: or 或运算
    # ==============================
    or $s7, $s4, $s5            # $s7 = 0x0000FF00 | 0x00005000 = 0x0000FF00
    or $t4, $zero, $zero        # $t4 = 0
    or $t5, $s6, $zero          # $t5 = 0x00000F0F
    
    # ==============================
    # 测试 5: xor 异或运算
    # ==============================
    xor $t6, $s7, $s7           # $t6 = 0 (自异或为0)
    xor $t7, $s0, $s1           # $t7 = 0x12345678 ^ 0x0000FFFF
    xor $v0, $t6, $t5           # $v0 = 0 ^ 0x00000F0F = 0x00000F0F
    
    # 验证 xor 自减结果
    bne $t6, $zero, fail        # 如果不等于0，跳转失败
    nop
    
    # ==============================
    # 测试 6: 复合逻辑运算
    # ==============================
    lui $v1, 0xAAAA
    ori $v1, $v1, 0xAAAA        # $v1 = 0xAAAAAAAA
    andi $a0, $v1, 0x5555       # $a0 = 0xAAAAAAAA & 0x5555 = 0x00000000
    ori $a1, $a0, 0x5555        # $a1 = 0x00005555
    
    HIT_GOOD_TRAP

fail:
    b fail
    nop